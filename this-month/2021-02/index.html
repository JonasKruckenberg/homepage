<!doctype html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Operating System Development in Rust">

    
        <link rel="canonical" href="https://rust-osdev.com/this-month/2021-02/" />
    
    <link href="/css/poole.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="RSS feed for rust-osdev.com" href="https://rust-osdev.com/rss.xml" />

    <title>This Month in Rust OSDev (February 2021) | Rust OSDev</title>
</head>

<body>
    <div class="wrap">
        <div class="masthead">
          <div class="container">
            <h3 class="masthead-title">
              <a href="https://rust-osdev.com" title="Home">Rust OSDev</a>
              <small>Operating System Development in Rust</small>
            </h3>
          </div>
        </div>
  
        <div class="container content">
            <main>
    <h1>This Month in Rust OSDev (February 2021)</h1>

    <span class="post-authors post-date">Written by
        <a href="https://github.com/phil-opp">@phil-opp</a>
        <br>Published on <time datetime="2021-03-08">
            Mar 08, 2021
            
        </time></span>

    <p>Welcome to a new issue of <em>&quot;This Month in Rust OSDev&quot;</em>. In these posts, we give a regular overview of notable changes in the Rust operating system development ecosystem.</p>
<span id="continue-reading"></span>
<p>This series is openly developed <a href="https://github.com/rust-osdev/homepage/">on GitHub</a>. Feel free to open pull requests there with content you would like to see in the next issue. If you find some issues on this page, please report them by <a href="https://github.com/rust-osdev/homepage/issues/new">creating an issue</a> or using our <a href="#comment-form"><em>comment form</em></a> at the bottom of this page.</p>
<!--
    This is a draft for the upcoming "This Month in Rust OSDev (February 2021)" post.
    Feel free to create pull requests against the `next` branch to add your
    content here.
    Please take a look at the past posts on https://rust-osdev.com/ to see the
    general structure of these posts.
-->
<h2 id="project-updates">Project Updates</h2>
<p>In this section, we give an overview of notable changes to the projects hosted under the <a href="https://github.com/rust-osdev/about"><code>rust-osdev</code></a> organization.</p>
<h3 id="uefi-rs"><a href="https://github.com/rust-osdev/uefi-rs"><code>uefi-rs</code></a></h3>
<p>The <code>uefi</code> crate provides safe and performant wrappers for <a href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a>, the successor to the BIOS. In February, we merged the following changes:</p>
<ul>
<li><a href="https://github.com/rust-osdev/uefi-rs/pull/201">Add helper function for retrieving the boot filesystem</a></li>
<li><a href="https://github.com/rust-osdev/uefi-rs/pull/200">Add support for the block I/O protocol</a></li>
<li><a href="https://github.com/rust-osdev/uefi-rs/pull/198">Update <code>x86_64</code> dependency to version 0.13.2</a> (to fix nightly breakage)</li>
<li><a href="https://github.com/rust-osdev/uefi-rs/pull/193">Fix some issues with the documentation of the <code>DevicePath</code> and <code>LoadedImage</code> protocols</a></li>
</ul>
<p>Thanks to <a href="https://github.com/gil0mendes">@gil0mendes</a>, <a href="https://github.com/sreehax">@sreehax</a>, and <a href="https://github.com/avirule">@avirule</a> for their contributions!</p>
<h3 id="x86-64"><a href="https://github.com/rust-osdev/x86_64"><code>x86_64</code></a></h3>
<p>The <code>x86_64</code> crate provides various abstractions for <code>x86_64</code> systems, including wrappers for CPU instructions, access to processor-specific registers, and abstraction types for architecture-specific structures such as page tables and descriptor tables.</p>
<p>In February, the unstable <a href="https://github.com/rust-lang/rust/issues/49147"><code>const_in_array_repeat_expressions</code> feature</a> was <a href="https://github.com/rust-lang/rust/pull/80404">removed</a> from Rust because it <a href="https://github.com/rust-lang/rust/issues/49147#issuecomment-766372999">implicitly changed drop behavior</a>. This lead to a compile error of the <code>x86_64</code> crate because it still had that feature enabled. Interestingly, we no longer needed this feature after <a href="https://github.com/rust-osdev/x86_64/pull/175">#175</a> (and an <a href="https://github.com/rust-lang/rust/pull/79270">accidental stabilization</a> in Rust), so the fix was quite simple:</p>
<ul>
<li><a href="https://github.com/rust-osdev/x86_64/pull/230">Fix build on latest nightly</a> <span class="gray">(published as <code>v0.13.2</code>)</span></li>
</ul>
<p>Thanks to <a href="https://github.com/KernelFreeze">@KernelFreeze</a> for this contribution!</p>
<h3 id="bootloader"><a href="https://github.com/rust-osdev/bootloader"><code>bootloader</code></a></h3>
<p>The <code>bootloader</code> crate implements a custom Rust-based bootloader for easy loading of 64-bit ELF executables. This month, we merged two small updates to fix build errors and warnings on newer Rust nightlies:</p>
<ul>
<li><a href="https://github.com/rust-osdev/bootloader/pull/135">Fix build on latest nightly by updating x86_64 to v0.13.2</a> <span class="gray">(published as <code>v0.9.12</code>)</span></li>
<li><a href="https://github.com/rust-osdev/bootloader/pull/138">Fix &quot;panic message is not a string literal&quot;</a> <span class="gray">(published as <code>v0.9.14</code>)</span></li>
</ul>
<p>Thanks to <a href="https://github.com/dspencer12">@dspencer12</a> for their contribution!</p>
<p>There was also some more progress on the <code>uefi</code> branch, which contains the upcoming new bootloader version with UEFI support:</p>
<ul>
<li><a href="https://github.com/rust-osdev/bootloader/commit/d55f1c87c34e8bba61adc6abffa78ba431aac69f">Improve reporting of config parse errors</a></li>
<li><a href="https://github.com/rust-osdev/bootloader/commit/6a0fd74ecb052ef3f1fa7ce3e556c895c66dfc4e">Add a test for the <code>map-physical-memory</code> config key</a></li>
<li>Add more checks for the given <code>--kernel-manifest</code> path: it should <a href="https://github.com/rust-osdev/bootloader/commit/38fd48622c3a6f22d64a65528a56d2471168cb78">point to a file named <code>Cargo.toml</code></a>, <a href="https://github.com/rust-osdev/bootloader/commit/9a8ace78650d75189d567618a90a4f039525f369">exist</a>, and the referenced <code>Cargo.toml</code> should <a href="https://github.com/rust-osdev/bootloader/commit/873351c575bdefd1c6c78b27de2bc0494698c0d5">depend on the bootloader crate</a>.</li>
</ul>
<p>The UEFI rewrite is almost done, but we still need to update the docs, improve the configurability of the framebuffer, and add more testing.</p>
<h3 id="uart-16550"><a href="https://github.com/rust-osdev/uart_16550"><code>uart_16550</code></a></h3>
<p>The <code>uart_16550</code> crate provides basic support for serial port I/O for 16550-compatible UARTs. Since the crate also depends on <code>x86_64</code>, it needed a dependency update to fix the mentioned build error on the latest nightly:</p>
<ul>
<li><a href="https://github.com/rust-osdev/uart_16550/pull/12">Fix build on nightly by updating to x86_64 v0.13.2</a> <span class="gray">(published as <code>v0.2.12</code>)</span></li>
</ul>
<h3 id="vga"><a href="https://github.com/rust-osdev/vga"><code>vga</code></a></h3>
<p>The work-in-progress <code>vga</code> crate allows the configuration of the VGA hardware, e.g. switching from text-based mode to a pixel-based graphics mode. The nightly build error of <code>x86_64</code> also affected this crate, so it needed a fix too:</p>
<ul>
<li><a href="https://github.com/rust-osdev/vga/pull/20">fix: should now compile</a> <span class="gray">(published as <code>v0.2.6</code>)</span></li>
</ul>
<p>Thanks to <a href="https://github.com/Pollux3737">@Pollux3737</a> for this contribution!</p>
<h2 id="personal-projects">Personal Projects</h2>
<p>In this section, we describe updates to personal projects that are not directly related to the <code>rust-osdev</code> organization. Feel free to <a href="https://github.com/rust-osdev/homepage/pulls">create a pull request</a> with the updates of your OS project for the next post.</p>
<h3 id="phil-opp-blog-os"><a href="https://github.com/phil-opp/blog_os"><code>phil-opp/blog_os</code></a></h3>
<p><span class="gray">(Section written by <a href="https://github.com/phil-opp">@phil-opp</a>)</span></p>
<p>The <a href="https://os.phil-opp.com/"><em>Writing an OS in Rust</em></a> blog received the following updates this month:</p>
<ul>
<li><a href="https://github.com/phil-opp/blog_os/pull/913">Translate post-08 to Persian</a></li>
<li><a href="https://github.com/phil-opp/blog_os/pull/917">Add ja translation for double faults</a></li>
<li><a href="https://github.com/phil-opp/blog_os/pull/920">Update post to use x86_64 v0.13.2</a></li>
<li><a href="https://github.com/phil-opp/blog_os/pull/932">Remove note on builtin memory optimizations</a>
<ul>
<li><a href="https://github.com/phil-opp/blog_os/pull/935">Remove it from Japanese translation as well</a></li>
</ul>
</li>
<li><a href="https://github.com/phil-opp/blog_os/pull/928">Minor fix in post 6</a></li>
<li><a href="https://github.com/phil-opp/blog_os/pull/927">Fix typo</a></li>
</ul>
<p>Thanks to <a href="https://github.com/MHBahrampour">@MHBahrampour</a>, <a href="https://github.com/garasubo">@garasubo</a>, <a href="https://github.com/dspencer12">@dspencer12</a>, <a href="https://github.com/toku-sa-n">@toku-sa-n</a>, and <a href="https://github.com/16yuki0702">@16yuki0702</a> for their contributions!</p>
<p>I also made some progress on the upcoming third edition. Some potentially interesting commits are:</p>
<ul>
<li><a href="https://github.com/phil-opp/blog_os/commit/acb478c0b51b0cdf2124772aca00502f15d6cbb6">Finish first draft of 'Minimal Kernel' post</a></li>
<li><a href="https://github.com/phil-opp/blog_os/commit/aaae70974f180321ab8bc25eca2052f98695b39a">Simplify boot crate</a></li>
<li><a href="https://github.com/phil-opp/blog_os/commit/c2fe9960a743bcb32d5a41e5a02e0f84266d950a">Add boilerplate for new 'UEFI Booting' post</a></li>
<li><a href="https://github.com/phil-opp/blog_os/commit/033be9ac25a146eb4819d9c6799bd6362d97e036">Explain how to create minimal UEFI app</a></li>
<li><a href="https://github.com/phil-opp/blog_os/commit/83be6c7868f269084ebe4758ad82db9d7f187061">Explain how to create FAT filesystem and GPT disk image</a></li>
</ul>
<h3 id="cdrzewiecki-celos"><a href="https://gitlab.com/cdrzewiecki/celos"><code>cdrzewiecki/celos</code></a></h3>
<p><span class="gray">(Section written by <a href="https://github.com/drzewiec">@drzewiec</a>)</span></p>
<p>I have been working on an OS following along with <a href="https://github.com/phil-opp">@phil-opp</a>'s tutorial series for a while, but recently decided I would rework my OS based on the first edition of the blog (since I preferred to use GRUB as my bootloader). This is the first progress I have to share on CelOS, and indeed the first time I've published one of these updates in general.</p>
<p>In February, I made a lot of great progress on CelOS. I have the complete physical memory (plus the framebuffer provided by GRUB) mapped to virtual memory, and a pixel-based framebuffer working with text output. Things are not very optimized right now (for one thing I'm stretching the <code>font8x8</code> font into 8x12), but this is a great first step that I can build on. Next planned steps are:</p>
<ul>
<li>Move the kernel in virtual memory so that it occupies the higher half of the 48-bit address space</li>
<li>Create some page fault interrupt handling so that the kernel can at least attempt to handle page faults (rather than triple faulting as it does now)</li>
<li>Set up memory allocation for the kernel, to get heap allocation</li>
<li>Once heap allocation is in place, utilize some existing crate to handle TrueType fonts so that text will look a bit nicer on screen</li>
</ul>
<p>I probably won't get all of that done in March, but those are my planned next steps. Thanks to this great community and to <a href="https://github.com/phil-opp">@phil-opp</a> for being so helpful in the osdev journey!</p>
<h2 id="join-us">Join Us?</h2>
<p>Are you interested in Rust-based operating system development? Our <code>rust-osdev</code> organization is always open to new members and new projects. Just let us know if you want to join! A good way for getting in touch is our <a href="https://rust-osdev.zulipchat.com">Zulip chat</a>.</p>


    <h2 id="comment-form">Comments</h2>

    <script src="https://utteranc.es/client.js"
        repo="rust-osdev/homepage"
        issue-term="url"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
</main>

            <footer class="footer">
                <hr>
                <small>Join us on <a href="https://rust-osdev.zulipchat.com">Zulip.</a><br>
                    &copy; <time datetime="2020">2020</time>-<time datetime="2022">2022</time>. All rights reserved.
                    <a href="https://rust-osdev.com/contact/">Contact</a>
                </small>
            </footer>
        </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
</body>

</html>
